\documentclass[conference]{IEEEtran}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\begin{document}

% ==================================================================
% TITLE
% ==================================================================
\title{Robust Electronic Nose System for Atmospheric Gas Classification using Normalized Kinetic Feature Extraction}

% ==================================================================
% AUTHORS
% ==================================================================
\author{\IEEEauthorblockN{Bysani Vedavyas, Shreyas Agarwal, Kushagra Agrawal, Devshree Vyas}
\IEEEauthorblockA{\textit{International Institute of Information Technology Hyderabad} \\
Hyderabad, India \\
}
}

\maketitle

% ==================================================================
% ABSTRACT
% ==================================================================
\begin{abstract}
Accurate and real-time identification of atmospheric gases is critical for industrial safety, environmental monitoring, and air quality assessment. However, traditional high-precision gas sensors are bulky and expensive. While Metal-Oxide Semiconductor (MOX) sensors offer a low-cost alternative, they suffer from cross-sensitivity and significant baseline drift, leading to poor selectivity in mixed-gas environments. This paper presents a robust ``Electronic Nose'' (E-Nose) system capable of accurately classifying multiple atmospheric gases utilizing a sensor array (MQ3, MQ136). The proposed system employs a novel \textbf{Phase-Space Trajectory Mapping} technique to decouple gas kinetics from sensor aging.

The system is built upon the ESP32 platform, which processes sensor resistance ratios in real-time. To overcome the inherent non-linearity and drift of MOX sensors, we introduce a normalized logarithmic derivative feature that transforms the transient response into a unique topological loop. A K-Nearest Neighbors (KNN) model trained on these phase-space trajectories achieves a peak classification accuracy of 88.84\% distinguishing between clean air, butane, and smoke. Furthermore, the system exhibits a rapid response time (typically 5--10 seconds) and $O(1)$ computational complexity. This work validates the feasibility of using low-cost MOX arrays combined with topological kinetic feature extraction as a reliable, drift-invariant solution for edge-based gas detection.
\end{abstract}

\begin{IEEEkeywords}
Electronic Nose (E-Nose), Metal Oxide Semiconductors (MOX), Phase Space Trajectory, Gas classification, Machine learning, Edge Computing.
\end{IEEEkeywords}

% ==================================================================
% I. INTRODUCTION
% ==================================================================
\section{Introduction}
Accurately detecting gases in the atmosphere is a significant challenge primarily because highly precise sensors are often expensive and bulky. Metal-Oxide Semiconductor (MOX) sensors utilize chemo-resistive properties to detect volatile compounds, offering a cost-effective alternative \cite{pearce2003handbook}. However, MOX sensors possess inherent limitations, specifically cross-sensitivity and sensor drift \cite{yamazoe2009new}. Cross-sensitivity refers to the phenomenon where a sensor intended to detect a specific gas (e.g., Gas B) also exhibits reactivity to interfering gases (e.g., Gas C and D), complicating single-gas detection. Furthermore, these sensors are prone to temporal drift. The sensing mechanism relies on surface redox reactions dependent on the active metal surface area. As the sensor undergoes thermal aging, the microstructure degrades, altering the baseline resistance $R_0$ (resistance in clean air) and leading to calibration errors over time \cite{korotcenkov2012instability}.

Previous research utilizing the electronic nose often trains models using either raw sensor resistance ($R_s$) or the simple resistance ratio $R_s/R_0$ \cite{yan2015enose}. However, models based on raw resistance values suffer from long-term inaccuracy due to sensor drift, which causes the baseline resistance to change. While using the $R_s/R_0$ ratio mitigates some variance, it is not entirely reliable due to ``iso-resistive ambiguity,'' where two distinct gases may momentarily produce identical $R_s/R_0$ values despite having different reaction kinetics. For instance, a sensor recovering from butane exposure may transiently exhibit an $R_s/R_0$ value identical to that of active smoke.

To address these challenges, this paper introduces a method that augments the feature vector to include not only the static ratio but also the normalized relative change of resistance. Our key contributions are:
\begin{itemize}
    \item \textbf{Theoretical:} We formulate a phase-space representation that mathematically decouples gas kinetics from sensor drift, proving that gas identity is a topological invariant even as $R_0$ shifts.
    \item \textbf{Algorithmic:} We introduce a linearized log-derivative approximation optimized for integer arithmetic, enabling complex chemometric analysis on low-power, single-core microcontrollers (ESP32).
    \item \textbf{System:} We demonstrate a real-time resolution of iso-resistive ambiguity on the Edge, achieving high accuracy without cloud dependence.
\end{itemize}

% ==================================================================
% II. THEORETICAL FRAMEWORK
% ==================================================================
\section{Theoretical Framework}

\subsection{Pseudo-First-Order Kinetics and Deviations}
Theoretically, the interaction between the target gas and the chemisorbed oxygen species on the sensor surface can be modeled as a pseudo-first-order kinetic reaction \cite{hjiri2022adsorption}. In an ideal scenario, the rate of reaction ($r$) is directly proportional to the concentration of the reactant:

\begin{equation}
-\frac{d[C]}{dt} = k[C]
\label{eq:kinetics}
\end{equation}

Where:
\begin{itemize}
    \item $[C]$ is the concentration of the gas.
    \item $k$ is the reaction rate constant, unique to the specific gas-sensor pair and temperature.
\end{itemize}

Since the sensor's change in conductivity is a direct consequence of this reaction, the ``Relative Rate of Change'' of the sensor's transient response serves as a proxy for the reaction rate. Therefore, if the reaction were perfectly first-order, determining this rate would theoretically allow for the identification of the unique rate constant ($k$) and, consequently, the gas type with high precision.

\subsection{Practical Deviations and the Necessity of an Array}
However, relying on a single sensor to extract these kinetic parameters is impractical for several reasons:

\subsubsection{Non-Ideal Power Law Behavior}
In real-world MOX sensors, the relationship between the sensor resistance ($R_s$) and gas concentration ($C$) follows an empirical Power Law ($R_s = A \cdot C^{-\alpha}$) rather than a strict linear relationship. Diffusion limitations within the porous sensor microstructure cause deviations from ideal kinetics, introducing non-linearities that a single measurement cannot fully resolve.

\subsubsection{Sampling \& Sensor Constraints}
Accurately calculating the instantaneous reaction rate constant ($k$) requires extremely high-frequency sampling to capture initial kinetics before diffusion equilibrium. In embedded systems, hardware limitations (ADC quantization noise) and physical sensor response lag prevent precise continuous-time differentiation.

\subsection{The Multi-Sensor Solution}
To overcome these limitations, this system employs an Electronic Nose (E-Nose) array. By utilizing multiple sensors with different metal-oxide compositions (yielding different selectivity coefficients $\alpha$ and rate constants $k$), a multi-dimensional response space is created. The combined vector of relative rates from the array provides a robust, unique signature for each gas, compensating for non-ideal kinetics.

% ==================================================================
% III. DERIVATION
% ==================================================================
\section{Derivation of Kinetic Descriptors}

\subsection{Derivation of the Normalized Kinetic Feature}
Assuming first-order kinetics as defined in (\ref{eq:kinetics}), we established that $\frac{dC}{dt} = -kC$. 
Secondly, the MOX sensor response typically exhibits linearity on a log-log scale. Thus, the resistance ratio $X = R_s/R_0$ can be modeled as:
\begin{equation}
\log(X) = m \log C + b
\end{equation}
Rearranging terms to the standard Power Law form:
\begin{equation}
X = 10^b C^m \quad \text{or} \quad \frac{R_s}{R_0} = A \cdot C^{-\alpha}
\end{equation}
Where $m$ (or $-\alpha$) represents the sensitivity slope. Differentiating the log-linear equation with respect to time:
\begin{equation}
\frac{d(\log X)}{dt} = m \frac{d(\log C)}{dt}
\end{equation}
Using the chain rule $\frac{d(\log u)}{dt} = \frac{1}{u}\frac{du}{dt}$:
\begin{equation}
\frac{1}{X} \frac{dX}{dt} = m \left( \frac{1}{C} \frac{dC}{dt} \right)
\end{equation}
Substituting $\frac{1}{C}\frac{dC}{dt} = -k$ from the kinetic equation:
\begin{equation}
\frac{1}{X} \frac{dX}{dt} = -mk
\label{eq:log_derivative}
\end{equation}
Equation (\ref{eq:log_derivative}) implies that theoretically, we can identify the gas type (via constants $m$ and $k$) with the help of log derivative.

\subsection{Discrete Implementation and Drift Independence}
In a real-world digital system, we deal with finite sampling intervals. While $X$ depends on $R_0$ (which drifts over time), the relative change feature depends only on the instantaneous resistance $R_s$. We approximate the logarithmic derivative as:
\begin{equation}
\frac{\Delta X}{X} = \frac{X(t+\Delta t) - X(t)}{X(t)} = \frac{\frac{R_s(t+\Delta t)}{R_0} - \frac{R_s(t)}{R_0}}{\frac{R_s(t)}{R_0}}
\end{equation}
The baseline $R_0$ cancels out, yielding:
\begin{equation}
\frac{\Delta X}{X} = \frac{R_s(t+\Delta t) - R_s(t)}{R_s(t)}
\end{equation}
This confirms that the feature is independent of the absolute baseline $R_0$.

\subsection{Error Analysis}
However, even with a perfect sensor following the ideal law $X(t) = X_0 e^{-mkt}$, discrete sampling introduces mathematical error. This error can be quantified as:
\begin{equation}
\frac{\Delta X}{X \Delta t} = \frac{e^{-mk(t+\Delta t)} - e^{-mkt}}{e^{-mkt} \Delta t} = \frac{e^{-mk\Delta t} - 1}{\Delta t}
\end{equation}
Using the Taylor series expansion $e^x \approx 1 + x + \frac{x^2}{2}$ for $x = -mk\Delta t$, we get:
\begin{equation}
\frac{\Delta X}{X \Delta t} \approx \frac{(1 - mk\Delta t + \frac{(mk\Delta t)^2}{2}) - 1}{\Delta t}
\end{equation}
\begin{equation}
\frac{\Delta X}{X \Delta t} \approx -mk + \frac{(mk)^2 \Delta t}{2}
\end{equation}
The term $\frac{(mk)^2 \Delta t}{2}$ represents the discretization error. Note that the total error may be further increased due to physical sensor lag and ADC quantization noise. This analysis confirms that while exact identification is impossible due to discrete sampling and nearly equal $mk$ values for similar gases, minimizing $\Delta t$ reduces the error linearly, allowing for robust classification in the phase space.

% ==================================================================
% IV. PHASE SPACE
% ==================================================================
\section{Phase Space Representation}
Having established in Section III that the normalized derivative ($\dot{X}/X$) is drift-independent, we now combine this kinetic feature with the thermodynamic state ($X$) to form a complete descriptor of the sensor's instantaneous behavior. Consequently, we define the feature space for our classification model as a trajectory in a two-dimensional phase space $(X, \dot{X}/X)$.

\begin{enumerate}
    \item \textbf{Thermodynamic State ($X$):} Represents the magnitude ($R_s/R_0$), corresponding to surface coverage.
    \item \textbf{Kinetic State ($\dot{X}/X$):} Represents the normalized logarithmic derivative. This captures the dynamic ``fingerprint'' of the gas, reflecting adsorption kinetics independent of concentration.
\end{enumerate}

This mapping decouples concentration-dependent magnitude from reaction-rate-dependent kinetics. By plotting these variables orthogonally, the transient response forms a unique topological loop, allowing the KNN model to distinguish gases even in the presence of drift.

% ==================================================================
% V. ROBUSTNESS
% ==================================================================
\section{Robustness \& Performance Analysis}

\subsection{Limitations of Raw Slope Analysis}
As established in prior literature, transient feature extraction provides a faster classification metric than steady-state analysis \cite{siadat2014detection}. However, utilizing the raw derivative ($dR/dt$) is susceptible to scale dependency. As MOX sensors age, $R_0$ shifts, causing the magnitude of $dR/dt$ to change even for the same gas concentration. This introduces ``Drift Noise'' into the classifier.

\subsection{Advantages of the Proposed Method}
The proposed Normalized Differential Feature approximates the Logarithmic Derivative ($d \ln R$), offering two distinct advantages:
\begin{itemize}
    \item \textbf{Scale Invariance:} As proven in Section III-B, normalizing $\Delta R$ against the current resistance $R_s(t)$ mathematically cancels out the drift parameter, ensuring feature stability over time.
    \item \textbf{Linearization:} As noted by Gardner \cite{gardner1991detection}, logarithmic parameters linearize the power-law response of MOX sensors. This transformation enhances the separability of classes in the feature space, optimizing performance for distance-based classifiers like KNN.
\end{itemize}

\subsection{Computational Efficiency}
The proposed logarithmic derivative calculation requires only two floating-point operations (FLOPs) per sampling interval ($t_s$), making it $O(1)$ in time complexity. This is significantly more efficient than Frequency Domain transforms (FFT) or Deep Learning approaches used in prior high-end implementations, allowing the ESP32 to maintain a high sampling rate (100 Hz) while concurrently managing the WiFi stack.

% ==================================================================
% VI. EXPERIMENTAL RESULTS
% ==================================================================
\section{Experimental Results and Analysis}

\subsection{Experimental Setup and Data Collection}
The proposed E-Nose system was evaluated using a dataset collected from a sensor array consisting of MQ-3 and MQ-136 sensors. The dataset includes samples across five states: Clean Air (No\_Gas), Butane, Smoke, and their respective recovery phases (After\_Butane, After\_Smoke). Feature extraction was performed to compute the resistance ratio ($R_s/R_0$) and the normalized logarithmic derivative ($\dot{R}/R$) for each sensor, resulting in a 4-dimensional feature space. To validate the classification model, the dataset was partitioned into a training set (80\%) and a testing set (20\%). A K-Nearest Neighbors (KNN) classifier with $k=5$ was employed.

\subsection{Phase Space Trajectory Analysis}
The phase space representation effectively captures the dynamic behavior of the sensors. Fig. \ref{fig:mq3_phase} and Fig. \ref{fig:mq136_phase} illustrate the trajectories of the MQ-3 and MQ-136 sensors in the 2D plane defined by the Thermodynamic State ($X$) and the Kinetic State ($\dot{X}/X$).

\begin{figure*}[htbp]
    \centering
    \begin{minipage}{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{fig_mq3_phase.jpg}
        \caption{MQ-3 Phase Space Trajectory. Note the tight clustering of 'No\_Gas' and the distinct loops for active gases.}
        \label{fig:mq3_phase}
    \end{minipage}\hfill
    \begin{minipage}{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{fig_mq136_phase.jpg}
        \caption{MQ-136 Phase Space Trajectory. The distinct shape compared to MQ-3 demonstrates the orthogonal sensitivity required for sensor fusion.}
        \label{fig:mq136_phase}
    \end{minipage}
\end{figure*}

As observed, the Clean Air samples cluster tightly, representing a stable baseline. The active gas states (Butane and Smoke) and their corresponding recovery states form distinct loops. Notably, the topological structure differs between the two sensors; this variance provides the necessary orthogonality for the classifier to resolve the 'iso-resistive' ambiguities described in Section II.

\subsection{Classification Performance}
The system achieved an overall classification accuracy of 88.84\% on the test set. The performance for specific classes is detailed in the Confusion Matrix (Fig. \ref{fig:confusion}) and summarized below:

\begin{figure}[htbp]
    \centerline{\includegraphics[width=\linewidth]{fig_confusion.png}}
    \caption{Confusion Matrix (KNN, k=5). The matrix highlights the system's safety reliability (0 false negatives for 'No\_Gas') despite the chemical similarity between Butane and Smoke.}
    \label{fig:confusion}
\end{figure}

\begin{itemize}
    \item \textbf{Clean Air Robustness:} The system maintained 100\% precision and recall for No\_Gas, ensuring zero false alarms in clean environments.
    \item \textbf{Smoke Detection:} Smoke was detected with high reliability (Precision: 84\%, Recall: 85\%), confirming the system's utility for fire safety monitoring.
    \item \textbf{Butane Sensitivity:} The classification of Butane presented a challenge (Recall: 63\%).
\end{itemize}

Analysis of the misclassified instances reveals that the primary confusion occurred with the `Smoke' class (12 instances), followed by the `After\_Butane' phase (5 instances). The current misclassification of Butane as Smoke indicates overlapping feature signatures (cross-sensitivity) in the existing sensor configuration. 

However, it is crucial to note that confusion with `No\_Gas' was negligible. This preserves the system's safety utility: while the system currently struggles to chemically distinguish Butane from Smoke, it successfully flags the presence of a foreign substance. Future iterations may resolve this by integrating additional sensors with orthogonal sensitivities to increase the dimensionality of the phase space and disentangle the active Butane state from general combustion byproducts.

\subsection{Sensor Fusion Validation}
A comparative analysis highlights the necessity of the sensor array. Individual sensors suffer from specific blind spots, but fusing their data creates a more robust classifier.
\begin{equation}
A_{MQ3} = \frac{332}{466} \approx 71.24\%
\end{equation}
\begin{equation}
A_{MQ136} = \frac{371}{466} \approx 79.61\%
\end{equation}
\begin{equation}
A_{Combined} = \frac{414}{466} \approx 88.84\%
\end{equation}

The combined array achieves 88.84\%, significantly outperforming the individual MQ-136 and MQ-3 configurations. This 9.2\% improvement over the best single sensor validates that the E-Nose approach provides significantly higher accuracy than individual sensors.

% ==================================================================
% VII. CONCLUSION
% ==================================================================
\section{Conclusion}
This paper presented a robust Electronic Nose system built on the ESP32 platform, utilizing a novel phase-space trajectory mapping to classify atmospheric gases. By leveraging the normalized logarithmic derivative, we demonstrated that gas identity can be extracted as a topological invariant, decoupling the classification from baseline sensor drift. Experimental results confirmed that fusing data from MQ-3 and MQ-136 sensors resolves iso-resistive ambiguities, achieving 88.84\% accuracy and maintaining 100\% reliability in distinguishing clean air from contaminants. While the current array exhibits some cross-sensitivity between Butane and Smoke, the modular design allows for future expansion with orthogonal sensors to further enhance selectivity. The proposed $O(1)$ algorithm proves that sophisticated chemometric analysis is feasible on low-cost edge devices, paving the way for affordable, distributed air quality monitoring networks.

% ==================================================================
% VIII. ACKNOWLEDGMENT
% ==================================================================
\section*{Acknowledgment}
The authors would like to thank Professor Abhishek Srivastava for his guidance and supervision throughout this research. We also extend our gratitude to our mentors, Alan Nelson and Srikar Somanchi, for their valuable insights and support in the development of this system.

% ==================================================================
% REFERENCES
% ==================================================================
\bibliographystyle{IEEEtran}
\begin{thebibliography}{00}

\bibitem{yan2015enose}
J. Yan \textit{et al.}, ``Electronic nose feature extraction methods: A review,'' \textit{Sensors}, vol. 15, no. 11, pp. 27804--27831, 2015.

\bibitem{yamazoe2009new}
N. Yamazoe and K. Shimanoe, ``New perspectives of gas sensor technology,'' \textit{Sensors and Actuators B: Chemical}, vol. 138, no. 1, pp. 100--107, 2009.

\bibitem{korotcenkov2012instability}
G. Korotcenkov and B. K. Cho, ``Instability of metal oxide gas sensors: Comparison of different approaches to drift compensation,'' \textit{Sensors and Actuators B: Chemical}, vol. 174, pp. 80--91, 2012.

\bibitem{siadat2014detection}
M. Siadat, E. Losson, D. Ahmadou, and M. Lumbreras, ``Detection Optimization Using a Transient Feature from a Metal Oxide Gas Sensor Array,'' \textit{Sensors \& Transducers}, vol. 171, no. 5, pp. 200--207, 2014.

\bibitem{gardner1991detection}
J. W. Gardner, ``Detection of vapours and odours from a multisensor array using pattern-recognition techniques,'' \textit{Sensors and Actuators B: Chemical}, vol. 4, no. 1-2, pp. 109--115, 1991.

\bibitem{pearce2003handbook}
T. C. Pearce, S. S. Schiffman, H. T. Nagle, and J. W. Gardner, \textit{Handbook of Machine Olfaction: Electronic Nose Technology}. Weinheim: Wiley-VCH, 2003.

\bibitem{hjiri2022adsorption}
M. Hjiri \textit{et al.}, ``Adsorption Kinetics of NO2 Gas on Pt/Cr-TiO2/Pt-Based Sensors,'' \textit{Processes}, vol. 10, no. 1, 2022.

\end{thebibliography}

\end{document}
